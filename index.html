<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<title>顏文字宇宙｜可可愛愛一鍵複製</title>
<meta name="description" content="顏文字宇宙｜收錄超可愛顏文字，一鍵複製使用，聊天、留言、社群都適合！">
<meta name="keywords" content="顏文字, kaomoji, 可愛, 哭哭, 生氣, 複製, 聊天, 表情符號">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { 
  font-family: system-ui, sans-serif; 
  max-width: 720px; 
  margin:auto; 
  padding:20px; 
  background:#f7f7f7; 
  line-height:1.8; 
}

h1 { 
  text-align:center; 
  margin-bottom:10px; 
}

/* 分類按鈕 */
.nav-buttons {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 8px;
  margin-bottom: 20px;
}

.nav-buttons button { 
  padding:8px 16px; 
  border:none; 
  border-radius:6px; 
  cursor:pointer; 
  background:#333; 
  color:#fff; 
  font-weight:bold; 
}

.nav-buttons button.active { 
  background:#007acc; 
}

.nav-buttons button:hover { 
  opacity:0.8; 
}

/* 顏文字容器自動排版 */
#kaomoji-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 10px;
}

.kaomoji { 
  background:#fff; 
  padding:10px; 
  border-radius:6px; 
  cursor:pointer; 
  text-align:center; 
  font-size:1.5rem; /* 相對字型大小，自動調整 */
  word-break: break-word;
  transition: transform 0.2s, background 0.2s;
}

.kaomoji:hover { 
  background:#eaeaea; 
  transform: scale(1.1);
}

/* Toast */
#copy-toast { 
  position:fixed; 
  bottom:30px; 
  left:50%; 
  transform:translateX(-50%); 
  background:#333; 
  color:#fff; 
  padding:10px 16px; 
  border-radius:20px; 
  font-size:14px; 
  opacity:0; 
  pointer-events:none; 
  transition:opacity .3s ease; 
  z-index:9999; 
}

#copy-toast.show { 
  opacity:1; 
}

a.sitemap-link { 
  display:block; 
  text-align:center; 
  margin-top:20px; 
  font-size:18px; 
  color:#007acc; 
  text-decoration:underline; 
}
</style>
</head>
<body>

<h1>顏文字宇宙</h1>
<p style="text-align:center;">點擊顏文字即可複製</p>

<!-- 分類按鈕 -->
<div class="nav-buttons" id="nav-buttons"></div>

<!-- 顯示顏文字區塊 -->
<div id="kaomoji-container"></div>

<!-- Toast -->
<div id="copy-toast">已複製</div>

<script>
// -------------------- 顯示顏文字的程式 --------------------
const toast = document.getElementById('copy-toast');
const navButtons = document.getElementById('nav-buttons');
const kaomojiContainer = document.getElementById('kaomoji-container');

// Google Sheets CSV URL (請改成你的)
const sheetURL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vQl0v6_nM1lyjhPNz3zjY8hELqL9Dg5z2ZU3F-9EFsPDpih9t8MVHpbA2x6wspDn3fYPyUT_oTnLiTR/pub?gid=0&single=true&output=csv";

let categories = {};

fetch(sheetURL)
  .then(res => res.text())
  .then(csvText => {
    const lines = csvText.split("\n").slice(1); // 忽略標題
    lines.forEach(line => {
      const parts = line.split(",");
      if(parts.length < 2) return;
      const kaomoji = parts[0].trim();
      const cat = parts[1].trim();
      if(!categories[cat]) categories[cat] = [];
      categories[cat].push(kaomoji);
    });

    // ✅ 在這裡檢查 categories 是否有資料
    console.log(categories);

    // 生成分類按鈕
    Object.keys(categories).forEach((cat,i) => {
      const btn = document.createElement("button");
      btn.textContent = cat;
      btn.dataset.cat = cat;
      if(i===0) btn.classList.add("active"); // 預設第一個分類
      btn.addEventListener("click",()=>showCategory(cat,btn));
      navButtons.appendChild(btn);
    });

    // 顯示第一個分類
    const firstCat = Object.keys(categories)[0];
    if(firstCat) showCategory(firstCat, navButtons.querySelector("button"));
  });

function showCategory(cat, btn){
  kaomojiContainer.innerHTML = "";
  document.querySelectorAll(".nav-buttons button").forEach(b=>b.classList.remove("active"));
  btn.classList.add("active");

  categories[cat].forEach(k=>{
    const div = document.createElement("div");
    div.className = "kaomoji";
    div.textContent = k;
    div.title = `${cat} 顏文字 ${k}`;
    div.addEventListener("click",()=>{
      navigator.clipboard.writeText(k);
      toast.textContent = '已複製：' + k;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"),1500);
    });
    kaomojiContainer.appendChild(div);
  });
}
</script>

</body>
</html>
